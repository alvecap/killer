<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Football Killer Pro</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html, body {
            overflow-x: hidden;
            height: 100%;
            width: 100%;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a1a2e 0%, #16213e 25%, #1a2f5a 50%, #2c4875 75%, #4a6fa5 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 8px;
        }

        .container {
            max-width: 100%;
            width: 100%;
            height: calc(100vh - 16px);
            display: flex;
            flex-direction: column;
        }

        h1 {
            text-align: center;
            margin-bottom: 10px;
            font-size: 1.8em;
            font-weight: 800;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.5);
            color: #ffffff;
            letter-spacing: 2px;
            text-transform: uppercase;
            flex-shrink: 0;
        }

        .app-title {
            background: linear-gradient(45deg, #ff6b35, #f7931e, #ffdc00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            display: inline-block;
            margin-left: 10px;
        }

        .prediction-form {
            background: rgba(255,255,255,0.98);
            padding: 12px;
            border-radius: 16px;
            box-shadow: 0 12px 30px rgba(0,0,0,0.3);
            margin-bottom: 8px;
            flex: 1;
            overflow-y: auto;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .form-section {
            margin-bottom: 16px;
            padding: 12px;
            background: linear-gradient(145deg, #f8f9fa, #e9ecef);
            border-radius: 12px;
            border-left: 4px solid #1a2f5a;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .section-title {
            font-size: 1em;
            font-weight: 700;
            color: #1a2f5a;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .form-group {
            margin-bottom: 10px;
        }

        label {
            display: block;
            margin-bottom: 4px;
            font-weight: 600;
            color: #2c4875;
            font-size: 0.85em;
        }

        input, select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e6ed;
            border-radius: 6px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #1a2f5a;
            box-shadow: 0 0 0 2px rgba(26, 47, 90, 0.1);
        }

        .teams-grid, .scores-grid {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 12px;
            align-items: end;
        }

        .vs {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            color: #1a2f5a;
            padding-bottom: 10px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .team-stats {
            background: white;
            padding: 12px;
            border-radius: 10px;
            border: 2px solid #f0f3f7;
            box-shadow: 0 4px 12px rgba(26, 47, 90, 0.1);
        }

        .team-stats h4 {
            color: #1a2f5a;
            margin-bottom: 10px;
            text-align: center;
            font-size: 0.9em;
            font-weight: 700;
        }

        .stat-row {
            display: grid;
            grid-template-columns: 1fr 60px;
            gap: 8px;
            align-items: center;
            margin-bottom: 8px;
        }

        .stat-row:last-child {
            margin-bottom: 0;
        }

        .stat-row label {
            font-size: 0.8em;
            margin-bottom: 0;
        }

        .stat-row input {
            padding: 6px;
            font-size: 13px;
        }

        .goals-prediction {
            margin-top: 12px;
        }

        .goals-section, .events-section {
            background: white;
            padding: 12px;
            border-radius: 10px;
            border: 2px solid #f0f3f7;
            margin-bottom: 10px;
            box-shadow: 0 4px 12px rgba(26, 47, 90, 0.1);
        }

        .goals-section h4, .events-section h4 {
            color: #1a2f5a;
            margin-bottom: 12px;
            text-align: center;
            font-size: 0.9em;
            font-weight: 700;
        }

        .goals-list, .events-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 10px;
        }

        .goal-item, .event-item {
            display: grid;
            grid-template-columns: auto 1fr auto auto auto;
            gap: 6px;
            align-items: center;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 6px;
            border: 1px solid #e9ecef;
        }

        .goal-item label, .event-item label {
            font-size: 0.75em;
            margin-bottom: 0;
            color: #666;
            font-weight: 600;
            white-space: nowrap;
        }

        .goal-item select, .goal-item input, .event-item select, .event-item input {
            padding: 4px;
            font-size: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .remove-goal, .remove-event {
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }

        .remove-goal:hover, .remove-event:hover {
            background: #c82333;
        }

        .add-goal-btn, .add-event-btn {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            padding: 8px 12px;
            border: none;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: all 0.2s;
        }

        .add-goal-btn:active, .add-event-btn:active {
            transform: translateY(1px);
        }

        .launch-btn {
            background: linear-gradient(45deg, #ff6b35, #f7931e);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 800;
            cursor: pointer;
            width: 100%;
            transition: all 0.2s;
            margin-top: 12px;
            box-shadow: 0 6px 16px rgba(255, 107, 53, 0.4);
            text-transform: uppercase;
            letter-spacing: 1px;
            flex-shrink: 0;
        }

        .launch-btn:active {
            transform: translateY(2px);
        }

        /* STYLES POUR LA SIMULATION - OPTIMISÉ MOBILE */
        .match-display {
            display: none;
            background: rgba(255,255,255,0.98);
            border-radius: 16px;
            box-shadow: 0 12px 30px rgba(0,0,0,0.3);
            height: calc(100vh - 16px);
            overflow: hidden;
            flex-direction: column;
            border: 1px solid rgba(255,255,255,0.2);
            position: relative;
        }

        .competition-header {
            background: linear-gradient(45deg, #ff6b35, #f7931e);
            color: white;
            padding: 10px;
            text-align: center;
            font-size: 1em;
            font-weight: 800;
            border-bottom: 2px solid #e85a2b;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            flex-shrink: 0;
        }

        .match-header {
            background: 
                linear-gradient(135deg, rgba(10, 26, 46, 0.95) 0%, rgba(22, 33, 62, 0.95) 50%, rgba(26, 47, 90, 0.95) 100%),
                radial-gradient(circle at 20% 80%, rgba(120, 255, 120, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 255, 120, 0.1) 0%, transparent 50%);
            color: white;
            padding: 12px 10px;
            text-align: center;
            position: relative;
            overflow: hidden;
            flex-shrink: 0;
        }

        .teams {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 12px;
            align-items: center;
            margin-bottom: 10px;
            min-height: 70px;
        }

        .team {
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 70px;
            max-width: 100%;
        }

        .team-name {
            font-size: 0.9em;
            font-weight: 700;
            margin-bottom: 6px;
            word-wrap: break-word;
            hyphens: auto;
            line-height: 1.2;
            max-width: 100%;
            overflow-wrap: break-word;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            padding: 0 4px;
        }

        .team-score {
            font-size: 2.2em;
            font-weight: 900;
            color: #ff6b35;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.6);
            line-height: 1;
            font-family: 'Arial Black', Arial, sans-serif;
        }

        .match-time-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 6px;
            min-height: 70px;
        }

        .match-time {
            font-size: 1.3em;
            font-weight: 800;
            text-align: center;
            background: rgba(255, 107, 53, 0.9);
            color: white;
            padding: 8px 14px;
            border-radius: 12px;
            border: 2px solid #ff6b35;
            min-width: 60px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.3);
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .halftime-score {
            font-size: 0.75em;
            background: rgba(255,255,255,0.2);
            padding: 4px 8px;
            border-radius: 6px;
            color: #ff6b35;
            font-weight: 700;
            border: 1px solid rgba(255, 107, 53, 0.3);
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255,255,255,0.2);
            border-radius: 3px;
            margin-top: 10px;
            border: 1px solid rgba(255,255,255,0.3);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff6b35, #f7931e);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 3px;
            box-shadow: 0 0 8px rgba(255, 107, 53, 0.5);
        }

        .statistics-table {
            margin: 8px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.2);
            overflow: hidden;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .stats-header {
            background: linear-gradient(135deg, #1a2f5a 0%, #2c4875 100%);
            color: white;
            padding: 10px;
            text-align: center;
            font-size: 0.9em;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 1px;
            flex-shrink: 0;
        }

        .stats-content {
            padding: 10px;
            flex: 1;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        /* POSSESSION SECTION COMPACTE */
        .possession-section {
            background: linear-gradient(145deg, #f8f9fa, #e9ecef);
            padding: 8px;
            border-radius: 8px;
            border: 1px solid #e9ecef;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .possession-title {
            text-align: center;
            font-size: 0.8em;
            font-weight: 700;
            color: #1a2f5a;
            margin-bottom: 6px;
        }

        .possession-display {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 8px;
            align-items: center;
        }

        .team-possession {
            text-align: center;
        }

        .team-possession-name {
            font-size: 0.7em;
            font-weight: 600;
            color: #2c4875;
            margin-bottom: 2px;
            word-wrap: break-word;
        }

        .possession-percentage {
            font-size: 1.1em;
            font-weight: 800;
            color: #ff6b35;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }

        .possession-bar-container {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .possession-bar {
            width: 80px;
            height: 6px;
            background: #e9ecef;
            border-radius: 3px;
            position: relative;
            overflow: hidden;
            border: 1px solid #dee2e6;
        }

        .possession-fill {
            height: 100%;
            background: linear-gradient(90deg, #1a2f5a, #2c4875);
            transition: width 0.8s ease-in-out;
            border-radius: 2px;
        }

        .vs-possession {
            font-size: 0.8em;
            font-weight: 700;
            color: #ff6b35;
        }

        /* STATS SECTION COMPACTE */
        .stats-section {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 8px;
            align-items: start;
        }

        .team-stats-display {
            text-align: center;
            max-width: 100%;
        }

        .team-stats-name {
            font-weight: 700;
            font-size: 0.8em;
            margin-bottom: 8px;
            color: #1a2f5a;
            border-bottom: 2px solid #ff6b35;
            padding-bottom: 4px;
            word-wrap: break-word;
            hyphens: auto;
            line-height: 1.2;
            overflow-wrap: break-word;
            max-width: 100%;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 6px 0;
            border-bottom: 1px solid #f0f3f7;
        }

        .stat-item:last-child {
            border-bottom: none;
        }

        .stat-label {
            font-weight: 600;
            color: #2c4875;
            font-size: 0.75em;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .stat-value {
            font-size: 1em;
            font-weight: 800;
            color: #1a2f5a;
            background: linear-gradient(145deg, #f8f9fa, #e9ecef);
            padding: 4px 8px;
            border-radius: 12px;
            min-width: 24px;
            text-align: center;
            border: 1px solid #e9ecef;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        }

        .teams-separator {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .separator-line {
            width: 2px;
            height: 40px;
            background: linear-gradient(180deg, #ff6b35, #f7931e, #ff6b35);
            border-radius: 1px;
            box-shadow: 0 0 8px rgba(255, 107, 53, 0.5);
        }

        .reset-btn {
            background: linear-gradient(45deg, #1a2f5a, #2c4875);
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 16px;
            font-size: 12px;
            font-weight: 700;
            cursor: pointer;
            margin: 8px;
            transition: transform 0.2s;
            width: calc(100% - 16px);
            box-shadow: 0 6px 16px rgba(26, 47, 90, 0.3);
            text-transform: uppercase;
            letter-spacing: 1px;
            flex-shrink: 0;
        }

        .reset-btn:active {
            transform: translateY(1px);
        }

        /* CÉLÉBRATIONS OPTIMISÉES */
        .goal-celebration {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: 
                radial-gradient(circle at center, rgba(255, 107, 53, 0.98) 0%, rgba(26, 47, 90, 0.95) 70%),
                linear-gradient(45deg, rgba(247, 147, 30, 0.4) 0%, rgba(255, 107, 53, 0.4) 100%);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: goalFlash 2s ease-out;
            padding: 16px;
        }

        .goal-content {
            text-align: center;
            color: white;
            position: relative;
            width: 100%;
            max-width: 90vw;
        }

        .goal-text {
            font-size: 3.5em;
            font-weight: 900;
            text-shadow: 4px 4px 12px rgba(0,0,0,0.8);
            animation: goalBounce 1s ease-out;
            margin-bottom: 16px;
            letter-spacing: 0.1em;
            font-family: 'Arial Black', Arial, sans-serif;
            line-height: 0.9;
            word-break: break-word;
            background: linear-gradient(45deg, #ffffff, #ff6b35, #ffffff, #f7931e);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            background-size: 200% 200%;
            animation: goalBounce 1s ease-out, gradientShift 1.5s ease-in-out infinite;
        }

        .goal-team {
            font-size: 1.4em;
            font-weight: 800;
            text-shadow: 2px 2px 6px rgba(0,0,0,0.7);
            animation: teamBounce 0.8s ease-out 0.2s both;
            background: linear-gradient(45deg, #f7931e, #ff6b35);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            word-break: break-word;
            line-height: 1.2;
            padding: 0 8px;
            margin-bottom: 12px;
        }

        .goal-effects {
            font-size: 2.5em;
            animation: effectsBounce 1.2s ease-out 0.4s both;
            filter: drop-shadow(0 6px 12px rgba(0,0,0,0.4));
        }

        .event-celebration {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(26, 47, 90, 0.95);
            color: white;
            padding: 16px 24px;
            border-radius: 12px;
            font-size: 1em;
            font-weight: 700;
            z-index: 999;
            display: none;
            text-align: center;
            box-shadow: 0 16px 40px rgba(0,0,0,0.7);
            border: 2px solid #ff6b35;
            animation: eventPop 0.4s ease-out;
        }

        /* ANIMATIONS */
        @keyframes goalFlash {
            0% { opacity: 0; transform: scale(0.8); }
            15% { opacity: 1; transform: scale(1.05); }
            85% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(1.02); }
        }

        @keyframes goalBounce {
            0% { transform: scale(0.2) rotate(-8deg); }
            50% { transform: scale(1.3) rotate(3deg); }
            100% { transform: scale(1) rotate(0deg); }
        }

        @keyframes teamBounce {
            0% { opacity: 0; transform: translateY(40px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        @keyframes effectsBounce {
            0% { opacity: 0; transform: translateY(50px) scale(0.3); }
            50% { transform: translateY(-15px) scale(1.3); }
            100% { opacity: 1; transform: translateY(0) scale(1); }
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes eventPop {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
            50% { transform: translate(-50%, -50%) scale(1.1); }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }

        /* RESPONSIVE MOBILE */
        @media (max-width: 390px) {
            h1 { font-size: 1.6em; margin-bottom: 8px; }
            .goal-text { font-size: 3em; margin-bottom: 12px; }
            .goal-team { font-size: 1.2em; padding: 0 6px; }
            .team-score { font-size: 2em; }
            .teams { gap: 10px; min-height: 60px; }
            .team-name { font-size: 0.8em; }
            .possession-bar { width: 60px; height: 5px; }
            .possession-percentage { font-size: 1em; }
            .stats-section { gap: 6px; }
            .match-time-container { min-height: 60px; }
            .match-time { font-size: 1.1em; padding: 6px 10px; }
        }

        @media (max-width: 350px) {
            .goal-text { font-size: 2.5em; letter-spacing: 0; }
            .goal-team { font-size: 1em; }
            h1 { font-size: 1.4em; }
            .team-score { font-size: 1.8em; }
            .team-name { font-size: 0.75em; }
            .possession-bar { width: 50px; height: 4px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🔥 <span class="app-title">FOOTBALL KILLER PRO</span></h1>
        
        <div class="prediction-form" id="predictionForm">
            <div class="form-section">
                <div class="section-title">🏆 Compétition</div>
                <div class="form-group">
                    <label for="competition">Nom de la compétition / Ligue</label>
                    <input type="text" id="competition" placeholder="Ex: Ligue 1, Premier League..." value="Ligue 1">
                </div>
            </div>

            <div class="form-section">
                <div class="section-title">⚽ Équipes</div>
                <div class="teams-grid">
                    <div class="form-group">
                        <label for="team1">Équipe Domicile</label>
                        <input type="text" id="team1" placeholder="Ex: Paris Saint-Germain" value="Paris Saint-Germain">
                    </div>
                    <div class="vs">VS</div>
                    <div class="form-group">
                        <label for="team2">Équipe Extérieur</label>
                        <input type="text" id="team2" placeholder="Ex: Olympique de Marseille" value="Olympique de Marseille">
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <div class="section-title">🎯 Prédiction du Score</div>
                <div class="scores-grid">
                    <div class="form-group">
                        <label for="score1">Score Domicile</label>
                        <input type="number" id="score1" min="0" max="20" value="2">
                    </div>
                    <div class="vs">-</div>
                    <div class="form-group">
                        <label for="score2">Score Extérieur</label>
                        <input type="number" id="score2" min="0" max="20" value="1">
                    </div>
                </div>
                
                <div class="goals-prediction" id="goalsPrediction">
                    <div class="goals-section">
                        <h4>⚽ Prédiction des Buts</h4>
                        <div class="goals-list" id="goalsList"></div>
                        <button type="button" class="add-goal-btn" onclick="addGoal()">+ Ajouter un but</button>
                    </div>
                </div>
            </div>

            <div class="form-section">
                <div class="events-section">
                    <h4>📝 Cartons et Changements</h4>
                    <div class="events-list" id="eventsList"></div>
                    <button type="button" class="add-event-btn" onclick="addEvent()">+ Ajouter un événement</button>
                </div>
            </div>

            <div class="form-section">
                <div class="section-title">📊 Prédictions Statistiques</div>
                
                <!-- Section Possession -->
                <div class="form-group">
                  <label>🎯 Possession de Balle (%)</label>
                    <div class="teams-grid">
                        <div class="form-group">
                            <label for="predPossession1">Possession Domicile (%)</label>
                            <input type="number" id="predPossession1" min="20" max="80" value="60">
                        </div>
                        <div class="vs">%</div>
                        <div class="form-group">
                            <label for="predPossession2">Possession Extérieur (%)</label>
                            <input type="number" id="predPossession2" min="20" max="80" value="40">
                        </div>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="team-stats">
                        <h4 id="statsTeamName1">Paris Saint-Germain</h4>
                        <div class="stat-row">
                            <label>🚩 Corners</label>
                            <input type="number" id="predCorners1" min="0" max="20" value="6">
                        </div>
                        <div class="stat-row">
                            <label>🟨 Cartons Jaunes</label>
                            <input type="number" id="predYellowCards1" min="0" max="10" value="2">
                        </div>
                        <div class="stat-row">
                            <label>⚠️ Fautes</label>
                            <input type="number" id="predFouls1" min="0" max="30" value="8">
                        </div>
                    </div>
                    
                    <div class="team-stats">
                        <h4 id="statsTeamName2">Olympique de Marseille</h4>
                        <div class="stat-row">
                            <label>🚩 Corners</label>
                            <input type="number" id="predCorners2" min="0" max="20" value="4">
                        </div>
                        <div class="stat-row">
                            <label>🟨 Cartons Jaunes</label>
                            <input type="number" id="predYellowCards2" min="0" max="10" value="3">
                        </div>
                        <div class="stat-row">
                            <label>⚠️ Fautes</label>
                            <input type="number" id="predFouls2" min="0" max="30" value="12">
                        </div>
                    </div>
                </div>
            </div>
            
            <button class="launch-btn" onclick="launchPrediction()">🚀 Lancer Football Killer Pro</button>
        </div>

        <!-- ÉCRAN DE SIMULATION -->
        <div class="match-display" id="matchDisplay" style="display: none;">
            <div class="competition-header" id="competitionDisplay">Ligue 1</div>
            
            <div class="match-header">
                <div class="teams">
                    <div class="team">
                        <div class="team-name" id="displayTeam1">Paris Saint-Germain</div>
                        <div class="team-score" id="displayScore1">0</div>
                    </div>
                    <div class="match-time-container">
                        <div class="match-time" id="matchTime">0'</div>
                        <div class="halftime-score" id="halftimeScore" style="display: none;">MI-TEMPS: 0-0</div>
                    </div>
                    <div class="team">
                        <div class="team-name" id="displayTeam2">Olympique de Marseille</div>
                        <div class="team-score" id="displayScore2">0</div>
                    </div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>

            <div class="statistics-table">
                <div class="stats-header">📊 Statistiques Live</div>
                <div class="stats-content">
                    
                    <!-- Section Possession Compacte -->
                    <div class="possession-section">
                        <div class="possession-title">🎯 Possession</div>
                        <div class="possession-display">
                            <div class="team-possession">
                                <div class="team-possession-name" id="possessionTeam1">Paris Saint-Germain</div>
                                <div class="possession-percentage" id="possessionPercentage1">60%</div>
                            </div>
                            <div class="possession-bar-container">
                                <div class="possession-bar">
                                    <div class="possession-fill" id="possessionFill"></div>
                                </div>
                            </div>
                            <div class="team-possession">
                                <div class="team-possession-name" id="possessionTeam2">Olympique de Marseille</div>
                                <div class="possession-percentage" id="possessionPercentage2">40%</div>
                            </div>
                        </div>
                    </div>

                    <!-- Section Statistiques -->
                    <div class="stats-section">
                        <div class="team-stats-display">
                            <div class="team-stats-name" id="statsTeam1">Paris Saint-Germain</div>
                            <div class="stat-item">
                                <span class="stat-label">🚩 Corners</span>
                                <span class="stat-value" id="corners1">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">🟨 Cartons</span>
                                <span class="stat-value" id="yellowCards1">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">⚠️ Fautes</span>
                                <span class="stat-value" id="fouls1">0</span>
                            </div>
                        </div>
                        
                        <div class="teams-separator">
                            <div class="separator-line"></div>
                        </div>
                        
                        <div class="team-stats-display">
                            <div class="team-stats-name" id="statsTeam2">Olympique de Marseille</div>
                            <div class="stat-item">
                                <span class="stat-label">🚩 Corners</span>
                                <span class="stat-value" id="corners2">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">🟨 Cartons</span>
                                <span class="stat-value" id="yellowCards2">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">⚠️ Fautes</span>
                                <span class="stat-value" id="fouls2">0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <button class="reset-btn" onclick="resetPrediction()">🔄 Nouvelle Prédiction</button>
        </div>
    </div>

    <!-- CÉLÉBRATIONS -->
    <div class="goal-celebration" id="goalCelebration">
        <div class="goal-content">
            <div class="goal-text">GOOOOOAL!</div>
            <div class="goal-team" id="goalTeamName">Paris Saint-Germain</div>
            <div class="goal-effects">⚽✨🎯</div>
        </div>
        <div class="confetti-container" id="confettiContainer"></div>
    </div>

    <div class="event-celebration" id="eventCelebration">
        <div id="eventText">🟨 Carton Jaune!</div>
    </div>

    <script>
        // VARIABLES GLOBALES
        let matchInterval;
        let possessionInterval;
        let currentTime = 0;
        let goals = [];
        let events = [];
        let predictedEvents = [];
        let currentScore1 = 0;
        let currentScore2 = 0;
        let halftimeScore1 = 0;
        let halftimeScore2 = 0;
        let corners1 = 0, corners2 = 0;
        let yellowCards1 = 0, yellowCards2 = 0;
        let fouls1 = 0, fouls2 = 0;
        
        // Variables pour la possession
        let currentPossession1 = 60;
        let currentPossession2 = 40;
        let targetPossession1 = 60;
        let targetPossession2 = 40;
        
        let targetCorners1, targetCorners2;
        let targetYellowCards1, targetYellowCards2;
        let targetFouls1, targetFouls2;
        let audioContext;
        let goalCounter = 0;
        let eventCounter = 0;
        let halftimeShown = false;

        // FONCTIONS AUDIO
        function initAudio() {
            try {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            } catch (e) {
                console.log('Audio non supporté');
            }
        }

        function playSound(type) {
            if (!audioContext) return;

            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            switch(type) {
                case 'goal':
                    const frequency = 400 + Math.random() * 200;
                    oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(frequency * 0.8, audioContext.currentTime + 0.4);
                    oscillator.frequency.exponentialRampToValueAtTime(frequency * 1.3, audioContext.currentTime + 0.8);
                    oscillator.frequency.exponentialRampToValueAtTime(frequency * 0.9, audioContext.currentTime + 1.2);
                    
                    gainNode.gain.setValueAtTime(0.8, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.6, audioContext.currentTime + 0.4);
                    gainNode.gain.exponentialRampToValueAtTime(0.4, audioContext.currentTime + 0.8);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1.2);
                    
                    oscillator.start();
                    oscillator.stop(audioContext.currentTime + 1.2);
                    break;
                    
                case 'whistle':
                    oscillator.frequency.setValueAtTime(2000, audioContext.currentTime);
                    gainNode.gain.setValueAtTime(0.4, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.6);
                    oscillator.start();
                    oscillator.stop(audioContext.currentTime + 0.6);
                    break;
                    
                case 'corner':
                    oscillator.frequency.setValueAtTime(1500, audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(1200, audioContext.currentTime + 0.2);
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                    oscillator.start();
                    oscillator.stop(audioContext.currentTime + 0.3);
                    break;
                    
                case 'yellow_card':
                    oscillator.frequency.setValueAtTime(1800, audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(1400, audioContext.currentTime + 0.15);
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.4);
                    oscillator.start();
                    oscillator.stop(audioContext.currentTime + 0.4);
                    break;
                    
                case 'foul':
                    oscillator.frequency.setValueAtTime(1000, audioContext.currentTime);
                    gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
                    oscillator.start();
                    oscillator.stop(audioContext.currentTime + 0.2);
                    break;

                case 'substitution':
                    oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(1200, audioContext.currentTime + 0.3);
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                    oscillator.start();
                    oscillator.stop(audioContext.currentTime + 0.5);
                    break;
            }
        }

        // GESTION DES ÉQUIPES
        document.getElementById('team1').addEventListener('input', function() {
            document.getElementById('statsTeamName1').textContent = this.value || 'Équipe 1';
            updateTeamNamesInGoals();
            updateTeamNamesInEvents();
        });

        document.getElementById('team2').addEventListener('input', function() {
            document.getElementById('statsTeamName2').textContent = this.value || 'Équipe 2';
            updateTeamNamesInGoals();
            updateTeamNamesInEvents();
        });

        // Synchronisation automatique des possessions
        document.getElementById('predPossession1').addEventListener('input', function() {
            const value1 = parseInt(this.value) || 50;
            const value2 = 100 - value1;
            document.getElementById('predPossession2').value = value2;
        });

        document.getElementById('predPossession2').addEventListener('input', function() {
            const value2 = parseInt(this.value) || 50;
            const value1 = 100 - value2;
            document.getElementById('predPossession1').value = value1;
        });

        document.getElementById('score1').addEventListener('input', updateGoalsFromScore);
        document.getElementById('score2').addEventListener('input', updateGoalsFromScore);

        function updateTeamNamesInGoals() {
            const team1Name = document.getElementById('team1').value || 'Équipe 1';
            const team2Name = document.getElementById('team2').value || 'Équipe 2';
            
            document.querySelectorAll('.team-select').forEach(select => {
                const currentValue = select.value;
                select.innerHTML = `
                    <option value="1">${team1Name}</option>
                    <option value="2">${team2Name}</option>
                `;
                select.value = currentValue;
            });
        }

        function updateTeamNamesInEvents() {
            const team1Name = document.getElementById('team1').value || 'Équipe 1';
            const team2Name = document.getElementById('team2').value || 'Équipe 2';
            
            document.querySelectorAll('.event-team-select').forEach(select => {
                const currentValue = select.value;
                select.innerHTML = `
                    <option value="1">${team1Name}</option>
                    <option value="2">${team2Name}</option>
                `;
                select.value = currentValue;
            });
        }

        // GESTION DES BUTS
        function addGoal(team = 1, minute = 15) {
            goalCounter++;
            const team1Name = document.getElementById('team1').value || 'Équipe 1';
            const team2Name = document.getElementById('team2').value || 'Équipe 2';
            
            const goalItem = document.createElement('div');
            goalItem.className = 'goal-item';
            goalItem.id = `goal-${goalCounter}`;
            
            goalItem.innerHTML = `
                <label>But ${goalCounter}</label>
                <select class="team-select" id="team-${goalCounter}">
                    <option value="1" ${team === 1 ? 'selected' : ''}>${team1Name}</option>
                    <option value="2" ${team === 2 ? 'selected' : ''}>${team2Name}</option>
                </select>
                <input type="number" id="minute-${goalCounter}" min="1" max="90" value="${minute}" placeholder="Minute">
                <input type="text" id="scorer-${goalCounter}" placeholder="Buteur (optionnel)">
                <button type="button" class="remove-goal" onclick="removeGoal(${goalCounter})">×</button>
            `;
            
            document.getElementById('goalsList').appendChild(goalItem);
        }

        function removeGoal(goalId) {
            const goalItem = document.getElementById(`goal-${goalId}`);
            if (goalItem) {
                goalItem.remove();
            }
        }

        // GESTION DES ÉVÉNEMENTS (UNIQUEMENT CEUX SPÉCIFIÉS PAR L'UTILISATEUR)
        function addEvent(type = 'yellow', team = 1, minute = 30) {
            eventCounter++;
            const team1Name = document.getElementById('team1').value || 'Équipe 1';
            const team2Name = document.getElementById('team2').value || 'Équipe 2';
            
            const eventItem = document.createElement('div');
            eventItem.className = 'event-item';
            eventItem.id = `event-${eventCounter}`;
            
            eventItem.innerHTML = `
                <label>Evt ${eventCounter}</label>
                <select class="event-type-select" id="eventType-${eventCounter}">
                    <option value="yellow" ${type === 'yellow' ? 'selected' : ''}>🟨 Carton Jaune</option>
                    <option value="substitution" ${type === 'substitution' ? 'selected' : ''}>🔄 Changement</option>
                </select>
                <select class="event-team-select" id="eventTeam-${eventCounter}">
                    <option value="1" ${team === 1 ? 'selected' : ''}>${team1Name}</option>
                    <option value="2" ${team === 2 ? 'selected' : ''}>${team2Name}</option>
                </select>
                <input type="number" id="eventMinute-${eventCounter}" min="1" max="90" value="${minute}" placeholder="Minute">
                <button type="button" class="remove-event" onclick="removeEvent(${eventCounter})">×</button>
            `;
            
            document.getElementById('eventsList').appendChild(eventItem);
        }

        function removeEvent(eventId) {
            const eventItem = document.getElementById(`event-${eventId}`);
            if (eventItem) {
                eventItem.remove();
            }
        }

        function updateGoalsFromScore() {
            const score1 = parseInt(document.getElementById('score1').value) || 0;
            const score2 = parseInt(document.getElementById('score2').value) || 0;
            const totalGoals = score1 + score2;
            const currentGoals = document.querySelectorAll('.goal-item').length;
            
            if (totalGoals > currentGoals) {
                let team1Goals = 0;
                let team2Goals = 0;
                
                document.querySelectorAll('.team-select').forEach(select => {
                    if (select.value === '1') team1Goals++;
                    else team2Goals++;
                });
                
                for (let i = currentGoals; i < totalGoals; i++) {
                    let teamToAdd = 1;
                    if (team1Goals < score1) {
                        teamToAdd = 1;
                        team1Goals++;
                    } else {
                        teamToAdd = 2;
                        team2Goals++;
                    }
                    addGoal(teamToAdd, 15 + i * 15);
                }
            }
            
            if (totalGoals < currentGoals) {
                const goalsToRemove = currentGoals - totalGoals;
                const allGoals = document.querySelectorAll('.goal-item');
                for (let i = 0; i < goalsToRemove; i++) {
                    if (allGoals[allGoals.length - 1 - i]) {
                        allGoals[allGoals.length - 1 - i].remove();
                    }
                }
            }
        }

        // Suite dans la partie 3...
        // GESTION DE LA POSSESSION AVEC MARGES
        function updatePossession() {
            // Calcul de la progression du match
            const progressRatio = currentTime / 90;
            
            // Marge de variation : ±5% de la prédiction finale
            const maxVariation = 5;
            const randomVariation = (Math.random() - 0.5) * maxVariation * 0.8; // Variation plus douce
            
            // Convergence progressive vers la cible finale
            const targetDiff1 = targetPossession1 - currentPossession1;
            
            // Vitesse de convergence qui augmente vers la fin du match
            const convergenceSpeed = 0.015 + (progressRatio * 0.02);
            
            // Application de la convergence avec variation aléatoire
            currentPossession1 += (targetDiff1 * convergenceSpeed) + (randomVariation * (1 - progressRatio * 0.5));
            
            // Application des marges : la possession peut varier de ±5% par rapport à la cible
            const minPossession1 = Math.max(25, targetPossession1 - 5);
            const maxPossession1 = Math.min(75, targetPossession1 + 5);
            
            currentPossession1 = Math.max(minPossession1, Math.min(maxPossession1, currentPossession1));
            currentPossession2 = 100 - currentPossession1;
            
            // À la fin du match, forcer la valeur exacte prédite
            if (currentTime >= 89) {
                currentPossession1 = targetPossession1;
                currentPossession2 = targetPossession2;
            }
            
            // Mise à jour de l'affichage
            document.getElementById('possessionPercentage1').textContent = Math.round(currentPossession1) + '%';
            document.getElementById('possessionPercentage2').textContent = Math.round(currentPossession2) + '%';
            document.getElementById('possessionFill').style.width = currentPossession1 + '%';
        }

        // FONCTION PRINCIPALE DE LANCEMENT
        function launchPrediction() {
            initAudio();
            
            const competition = document.getElementById('competition').value || 'Compétition';
            const team1 = document.getElementById('team1').value || 'Équipe 1';
            const team2 = document.getElementById('team2').value || 'Équipe 2';

            // Récupération des prédictions
            targetPossession1 = parseInt(document.getElementById('predPossession1').value) || 60;
            targetPossession2 = parseInt(document.getElementById('predPossession2').value) || 40;
            targetCorners1 = parseInt(document.getElementById('predCorners1').value) || 0;
            targetCorners2 = parseInt(document.getElementById('predCorners2').value) || 0;
            targetYellowCards1 = parseInt(document.getElementById('predYellowCards1').value) || 0;
            targetYellowCards2 = parseInt(document.getElementById('predYellowCards2').value) || 0;
            targetFouls1 = parseInt(document.getElementById('predFouls1').value) || 0;
            targetFouls2 = parseInt(document.getElementById('predFouls2').value) || 0;

            // Reset des variables
            currentTime = 0;
            currentScore1 = 0;
            currentScore2 = 0;
            halftimeScore1 = 0;
            halftimeScore2 = 0;
            halftimeShown = false;
            corners1 = 0; corners2 = 0;
            yellowCards1 = 0; yellowCards2 = 0;
            fouls1 = 0; fouls2 = 0;
            
            // Initialisation de la possession avec variation initiale
            currentPossession1 = targetPossession1 + (Math.random() - 0.5) * 8;
            currentPossession2 = 100 - currentPossession1;
            
            goals = [];
            events = [];
            predictedEvents = [];

            generateGoals();
            generateEvents();
            generatePredictedEvents();

            // Changement d'écran
            document.getElementById('predictionForm').style.display = 'none';
            document.getElementById('matchDisplay').style.display = 'flex';
            
            // Mise à jour de l'affichage
            document.getElementById('competitionDisplay').textContent = competition;
            document.getElementById('displayTeam1').textContent = team1;
            document.getElementById('displayTeam2').textContent = team2;
            document.getElementById('statsTeam1').textContent = team1;
            document.getElementById('statsTeam2').textContent = team2;
            document.getElementById('possessionTeam1').textContent = team1;
            document.getElementById('possessionTeam2').textContent = team2;
            
            document.getElementById('displayScore1').textContent = '0';
            document.getElementById('displayScore2').textContent = '0';
            document.getElementById('matchTime').textContent = "0'";
            document.getElementById('progressFill').style.width = '0%';
            document.getElementById('halftimeScore').style.display = 'none';
            updateStats();
            updatePossession();

            playSound('whistle');
            matchInterval = setInterval(updateMatch, 600);
            possessionInterval = setInterval(updatePossession, 2000);
        }

        // GÉNÉRATION DES BUTS
        function generateGoals() {
            goals = [];
            
            document.querySelectorAll('.goal-item').forEach((goalItem, index) => {
                const teamSelect = goalItem.querySelector('.team-select');
                const minuteInput = goalItem.querySelector('input[type="number"]');
                const scorerInput = goalItem.querySelector('input[type="text"]');
                
                if (teamSelect && minuteInput) {
                    const team = parseInt(teamSelect.value);
                    const minute = parseInt(minuteInput.value) || (15 + index * 15);
                    const scorer = scorerInput ? scorerInput.value : '';
                    goals.push({ 
                        team: team, 
                        minute: Math.min(90, Math.max(1, minute)),
                        scorer: scorer
                    });
                }
            });
            
            goals.sort((a, b) => a.minute - b.minute);
        }

        // GÉNÉRATION DES ÉVÉNEMENTS (UNIQUEMENT CEUX SPÉCIFIÉS)
        function generateEvents() {
            events = [];
            
            document.querySelectorAll('.event-item').forEach((eventItem, index) => {
                const typeSelect = eventItem.querySelector('.event-type-select');
                const teamSelect = eventItem.querySelector('.event-team-select');
                const minuteInput = eventItem.querySelector('input[type="number"]');
                
                if (typeSelect && teamSelect && minuteInput) {
                    const type = typeSelect.value;
                    const team = parseInt(teamSelect.value);
                    const minute = parseInt(minuteInput.value) || (30 + index * 20);
                    
                    events.push({
                        type: type,
                        team: team,
                        minute: Math.min(90, Math.max(1, minute))
                    });
                }
            });
            
            events.sort((a, b) => a.minute - b.minute);
        }

        // GÉNÉRATION DES ÉVÉNEMENTS PRÉDITS (CORNERS ET FAUTES AUTOMATIQUES)
        function generatePredictedEvents() {
            predictedEvents = [];
            
            // Distribution intelligente des corners
            for (let i = 0; i < targetCorners1; i++) {
                const minute = Math.floor((i + 1) * (90 / (targetCorners1 + 1))) + Math.floor(Math.random() * 10) - 5;
                predictedEvents.push({
                    type: 'corner',
                    team: 1,
                    minute: Math.max(1, Math.min(89, minute))
                });
            }
            for (let i = 0; i < targetCorners2; i++) {
                const minute = Math.floor((i + 1) * (90 / (targetCorners2 + 1))) + Math.floor(Math.random() * 10) - 5;
                predictedEvents.push({
                    type: 'corner',
                    team: 2,
                    minute: Math.max(1, Math.min(89, minute))
                });
            }
            
            // Distribution des cartons jaunes automatiques (selon prédictions)
            for (let i = 0; i < targetYellowCards1; i++) {
                predictedEvents.push({
                    type: 'auto_yellow_card',
                    team: 1,
                    minute: Math.floor(Math.random() * 89) + 1
                });
            }
            for (let i = 0; i < targetYellowCards2; i++) {
                predictedEvents.push({
                    type: 'auto_yellow_card',
                    team: 2,
                    minute: Math.floor(Math.random() * 89) + 1
                });
            }
            
            // Distribution des fautes
            for (let i = 0; i < targetFouls1; i++) {
                predictedEvents.push({
                    type: 'foul',
                    team: 1,
                    minute: Math.floor(Math.random() * 89) + 1
                });
            }
            for (let i = 0; i < targetFouls2; i++) {
                predictedEvents.push({
                    type: 'foul',
                    team: 2,
                    minute: Math.floor(Math.random() * 89) + 1
                });
            }
            
            predictedEvents.sort((a, b) => a.minute - b.minute);
        }

        // CÉLÉBRATION DE BUT (2 SECONDES MAX)
        function showGoalCelebration(team, scorer = '') {
            const celebration = document.getElementById('goalCelebration');
            const goalTeamElement = document.getElementById('goalTeamName');
            const teamName = team === 1 ? 
                document.getElementById('displayTeam1').textContent : 
                document.getElementById('displayTeam2').textContent;
            
            let displayText = teamName;
            if (scorer) {
                displayText += ` (${scorer})`;
            }
            
            goalTeamElement.textContent = displayText;
            celebration.style.display = 'flex';
            
            createExplosiveConfetti();
            playSound('goal');

            // Durée maximale de 2 secondes
            setTimeout(() => {
                celebration.style.display = 'none';
                const confettis = celebration.querySelectorAll('.confetti');
                confettis.forEach(confetti => confetti.remove());
            }, 2000);
        }

        // CÉLÉBRATION D'ÉVÉNEMENT (1 SECONDE MAX)
        function showEventCelebration(eventType, team) {
            const celebration = document.getElementById('eventCelebration');
            const eventText = document.getElementById('eventText');
            const teamName = team === 1 ? 
                document.getElementById('displayTeam1').textContent : 
                document.getElementById('displayTeam2').textContent;
            
            let text = '';
            let soundType = '';
            switch(eventType) {
                case 'yellow':
                    text = `🟨 Carton Jaune - ${teamName}`;
                    soundType = 'yellow_card';
                    break;
                case 'substitution':
                    text = `🔄 Changement - ${teamName}`;
                    soundType = 'substitution';
                    break;
            }
            
            eventText.textContent = text;
            celebration.style.display = 'block';
            playSound(soundType);
            
            // Durée maximale de 1 seconde
            setTimeout(() => {
                celebration.style.display = 'none';
            }, 1000);
        }

        // CRÉATION DES CONFETTIS OPTIMISÉE
        function createExplosiveConfetti() {
            const celebration = document.getElementById('goalCelebration');
            const colors = ['#ff6b35', '#f7931e', '#1a2f5a', '#2c4875', '#4a6fa5', '#ffffff', '#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#feca57', '#ff9ff3', '#54a0ff'];
            
            let confettiContainer = celebration.querySelector('.confetti-container');
            if (!confettiContainer) {
                confettiContainer = document.createElement('div');
                confettiContainer.className = 'confetti-container';
                celebration.appendChild(confettiContainer);
            }
            
            // Moins de confettis pour les mobiles (performance)
            for (let i = 0; i < 60; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = Math.random() * 1 + 's';
                confetti.style.animationDuration = (Math.random() * 1 + 1.5) + 's';
                
                // Formes variées mais plus simples
                if (Math.random() < 0.3) {
                    confetti.style.borderRadius = '0';
                    confetti.style.transform = 'rotate(45deg)';
                }
                if (Math.random() < 0.2) {
                    confetti.style.width = '16px';
                    confetti.style.height = '8px';
                    confetti.style.borderRadius = '8px';
                }
                
                confettiContainer.appendChild(confetti);
            }
        }

        // MISE À JOUR DU MATCH
        function updateMatch() {
            currentTime++;
            
            document.getElementById('matchTime').textContent = currentTime + "'";
            document.getElementById('progressFill').style.width = (currentTime / 90) * 100 + '%';

            // Affichage du score mi-temps à la 45e minute
            if (currentTime === 45 && !halftimeShown) {
                halftimeScore1 = currentScore1;
                halftimeScore2 = currentScore2;
                document.getElementById('halftimeScore').textContent = `MI-TEMPS: ${halftimeScore1}-${halftimeScore2}`;
                document.getElementById('halftimeScore').style.display = 'block';
                halftimeShown = true;
                playSound('whistle');
            }

            // Gestion des buts
            goals.forEach(goal => {
                if (goal.minute === currentTime && !goal.displayed) {
                    if (goal.team === 1) {
                        currentScore1++;
                        document.getElementById('displayScore1').textContent = currentScore1;
                        showGoalCelebration(1, goal.scorer);
                    } else {
                        currentScore2++;
                        document.getElementById('displayScore2').textContent = currentScore2;
                        showGoalCelebration(2, goal.scorer);
                    }
                    goal.displayed = true;
                }
            });

            // Gestion des événements personnalisés
            events.forEach(event => {
                if (event.minute === currentTime && !event.displayed) {
                    switch(event.type) {
                        case 'yellow':
                            if (event.team === 1) yellowCards1++; else yellowCards2++;
                            showEventCelebration('yellow', event.team);
                            updateStats();
                            break;
                        case 'substitution':
                            showEventCelebration('substitution', event.team);
                            break;
                    }
                    event.displayed = true;
                }
            });

            // Gestion des événements automatiques
            predictedEvents.forEach(event => {
                if (event.minute === currentTime && !event.displayed) {
                    switch(event.type) {
                        case 'corner':
                            if (event.team === 1) corners1++; else corners2++;
                            playSound('corner');
                            updateStats();
                            break;
                        case 'auto_yellow_card':
                            if (event.team === 1) yellowCards1++; else yellowCards2++;
                            playSound('yellow_card');
                            updateStats();
                            break;
                        case 'foul':
                            if (event.team === 1) fouls1++; else fouls2++;
                            playSound('foul');
                            updateStats();
                            break;
                    }
                    event.displayed = true;
                }
            });

            // Fin du match
            if (currentTime >= 90) {
                clearInterval(matchInterval);
                clearInterval(possessionInterval);
                playSound('whistle');
                document.getElementById('matchTime').textContent = "FIN";
                document.getElementById('progressFill').style.width = '100%';
                
                // Finalisation de la possession aux valeurs exactes prédites
                currentPossession1 = targetPossession1;
                currentPossession2 = targetPossession2;
                updatePossession();
            }
        }

        // MISE À JOUR DES STATISTIQUES
        function updateStats() {
            document.getElementById('corners1').textContent = corners1;
            document.getElementById('corners2').textContent = corners2;
            document.getElementById('yellowCards1').textContent = yellowCards1;
            document.getElementById('yellowCards2').textContent = yellowCards2;
            document.getElementById('fouls1').textContent = fouls1;
            document.getElementById('fouls2').textContent = fouls2;
        }

        // RESET DE LA PRÉDICTION
        function resetPrediction() {
            if (matchInterval) {
                clearInterval(matchInterval);
            }
            if (possessionInterval) {
                clearInterval(possessionInterval);
            }
            
            document.getElementById('predictionForm').style.display = 'block';
            document.getElementById('matchDisplay').style.display = 'none';
            document.getElementById('goalCelebration').style.display = 'none';
            document.getElementById('eventCelebration').style.display = 'none';
        }

        // INITIALISATION
        function initializeApp() {
            // Buts par défaut
            addGoal(1, 25);
            addGoal(1, 65);
            addGoal(2, 80);

            // Événements par défaut (uniquement ceux spécifiés par l'utilisateur)
            addEvent('yellow', 1, 35);
            addEvent('substitution', 2, 60);
        }

        // ACTIVATION AUDIO AU PREMIER CLIC
        document.addEventListener('click', () => {
            if (audioContext && audioContext.state === 'suspended') {
                audioContext.resume();
            }
        }, { once: true });

        // OPTIMISATION MOBILE
        document.addEventListener('touchstart', function() {}, true);

        // PRÉVENTION DU SCROLL SUR MOBILE LORS DE LA SIMULATION
        let isSimulationMode = false;

        function preventScroll(e) {
            if (isSimulationMode) {
                e.preventDefault();
            }
        }

        // Observer pour détecter le changement de mode
        const observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                if (mutation.target.id === 'matchDisplay') {
                    isSimulationMode = mutation.target.style.display === 'flex';
                    if (isSimulationMode) {
                        document.body.style.overflow = 'hidden';
                        document.addEventListener('touchmove', preventScroll, { passive: false });
                    } else {
                        document.body.style.overflow = '';
                        document.removeEventListener('touchmove', preventScroll);
                    }
                }
            });
        });

        // LANCEMENT DE L'APPLICATION
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            
            // Observer les changements d'affichage
            observer.observe(document.getElementById('matchDisplay'), {
                attributes: true,
                attributeFilter: ['style']
            });
        });

    </script>
</body>
</html>   
